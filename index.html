<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Reto Lagartijas 365</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="manifest" href="manifest.json">

<style>
body {
  margin: 0;
  font-family: "Segoe UI", Roboto, sans-serif;
  background: #0f172a;
  color: #e5e7eb;
}
.app {
  max-width: 400px;
  margin: auto;
  padding: 20px;
}
.card {
  background: #1e293b;
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 15px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.4);
  text-align: center;
}
h1 {
  text-align: center;
  font-size: 28px;
  margin-bottom: 20px;
}
.big {
  font-size: 64px;
  font-weight: bold;
  color: #22c55e;
  margin: 10px 0;
}
.button {
  width: 100%;
  padding: 14px;
  font-size: 16px;
  border-radius: 12px;
  border: none;
  background: #22c55e;
  color: #022c22;
  font-weight: bold;
  margin-top: 12px;
  cursor: pointer;
}
.button:disabled {
  background: #334155;
  color: #94a3b8;
}
.small {
  font-size: 14px;
  opacity: 0.7;
}
.stats {
  display: flex;
  justify-content: space-between;
  margin-top: 12px;
}
.stat {
  text-align: center;
}
.progress {
  height: 12px;
  background: #334155;
  border-radius: 12px;
  overflow: hidden;
  margin-top: 12px;
}
.progress div {
  height: 100%;
  width: 0%;
  background: #22c55e;
  transition: width 0.4s;
}
</style>
</head>

<body>
<div class="app">

<h1>Reto Lagartijas 365</h1>

<div class="card" id="todayCard">
  <p class="small" id="fecha"></p>
  <div class="big" id="lagartijas">0</div>
  <div class="small" id="calorias">CalorÃ­as: 0 cal</div>
  <p class="small" id="mensaje">Â¡Vamos con las lagartijas de hoy!</p>
  <button class="button" id="doneBtn">YA LAS HICE</button>
</div>

<div class="card">
  <div class="stats">
    <div class="stat">
      <b id="racha">0</b><br>ðŸ”¥ Racha
    </div>
    <div class="stat">
      <b id="total">0</b><br>ðŸ“Š Total
    </div>
  </div>
  <div class="progress">
    <div id="barra"></div>
  </div>
  <div class="small" id="promedio">Promedio diario: 0 cal</div>
</div>

<div class="card">
  <button class="button" id="resetBtn" style="background:#ef4444;color:white;">ðŸ”„ Reiniciar Reto</button>
</div>

<p class="small" style="text-align:center;margin-top:10px;">Disciplina > motivaciÃ³n</p>

</div>

<script>
// --- ConfiguraciÃ³n ---
const K = { start:"start", done:"done", streak:"streak", total:"total", cal:"cal", last:"last" };
const calPorLagartija = 0.5;

let start = localStorage.getItem(K.start);
if(!start){ start=new Date().toISOString().split("T")[0]; localStorage.setItem(K.start,start); }

const today=new Date();
const dayKey=today.toISOString().split("T")[0];
const diff=Math.floor((today-new Date(start))/(1000*60*60*24))+1;
let calHoy = diff*calPorLagartija;

// --- Elementos ---
const lagartijas=document.getElementById("lagartijas");
const fecha=document.getElementById("fecha");
const mensaje=document.getElementById("mensaje");
const caloriasEl=document.getElementById("calorias");
const doneBtn=document.getElementById("doneBtn");
const rachaEl=document.getElementById("racha");
const totalEl=document.getElementById("total");
const barra=document.getElementById("barra");
const promedioEl=document.getElementById("promedio");
const todayCard=document.getElementById("todayCard");
const resetBtn=document.getElementById("resetBtn");

// --- Mostrar dÃ­a ---
lagartijas.textContent=diff;
fecha.textContent=today.toLocaleDateString();
caloriasEl.textContent=`CalorÃ­as: ${calHoy.toFixed(1)} cal`;

// --- Estado guardado ---
let done=JSON.parse(localStorage.getItem(K.done))||[];
let streak=Number(localStorage.getItem(K.streak))||0;
let total=Number(localStorage.getItem(K.total))||0;
let totalCal=Number(localStorage.getItem(K.cal))||0;

rachaEl.textContent=streak;
totalEl.textContent=total;
barra.style.width=Math.min((streak/365)*100,100)+"%";
promedioEl.textContent=`Promedio diario: ${totalCal/diff ? (totalCal/diff).toFixed(1) : 0} cal`;

// --- BotÃ³n desactivado si ya se hizo ---
if(done.includes(dayKey)) doneBtn.disabled=true;

// --- AcciÃ³n al hacer la lagartija ---
doneBtn.onclick=()=>{
  done.push(dayKey);
  localStorage.setItem(K.done,JSON.stringify(done));

  const last=localStorage.getItem(K.last);
  streak=last && (new Date(dayKey)-new Date(last))/(86400000)===1 ? streak+1 : 1;

  total+=diff;
  totalCal+=calHoy;

  localStorage.setItem(K.streak,streak);
  localStorage.setItem(K.total,total);
  localStorage.setItem(K.cal,totalCal);
  localStorage.setItem(K.last,dayKey);

  rachaEl.textContent=streak;
  totalEl.textContent=total;
  barra.style.width=Math.min((streak/365)*100,100)+"%";
  promedioEl.textContent=`Promedio diario: ${(totalCal/diff).toFixed(1)} cal`;

  mensaje.textContent=streak>1 ? "Â¡Excelente dÃ­a! ðŸ”¥" : "Â¡Sigue asÃ­! ðŸ’ª";

  doneBtn.disabled=true;
};

// --- Reiniciar reto ---
resetBtn.onclick=()=>{
  if(confirm("Â¿Seguro que querÃ©s reiniciar el reto? Se borrarÃ¡n todos tus datos.")){
    localStorage.clear();
    location.reload();
  }
};
</script>
</body>
</html>
